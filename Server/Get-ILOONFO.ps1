Import-Module -Name HPiLOCmdlets

@"
10.12.1.15
10.12.1.17
10.12.1.19
10.12.1.21
10.12.1.23
10.12.1.235
10.12.1.241
10.12.1.28
10.12.1.30
10.12.1.39
10.12.1.41
10.12.1.43
10.12.1.45
10.12.111.49
10.12.111.59
10.12.111.69
10.12.112.149
10.12.112.159
10.12.112.169
10.12.113.126
10.12.113.13
10.12.113.15
10.12.114.24
10.12.127.31
10.12.2.16
10.12.96.41
10.12.96.43
10.12.96.45?
10.12.96.48?
10.12.96.50
10.201.65.22
10.201.65.24?
10.201.65.245
10.201.65.249
10.201.65.26?
10.201.65.28?
10.201.65.30?
10.201.65.34?
145.228.3.30
162.49.123.11
162.49.123.129
162.49.123.13
162.49.123.139
162.49.123.149
162.49.123.149
162.49.123.159
162.49.123.169
162.49.129.12
162.49.153.163
162.49.153.167
162.49.16.120
162.49.16.121
162.49.16.122
162.49.16.126
162.49.192.143
162.49.192.146
162.49.225.170
162.49.33.20
162.49.33.22
162.49.50.16
162.49.50.32
162.49.50.34
162.49.50.43
162.49.50.46
162.49.50.48
162.49.60.45
162.49.75.110
162.49.82.226
162.49.82.227
162.49.82.228
162.49.82.229
162.49.82.230
162.49.82.231
162.49.83.11
162.49.83.13
162.49.83.15
162.49.83.17
162.49.83.59
162.49.83.69
162.49.83.79
162.49.83.89
162.49.84.15
162.49.84.20
162.49.84.209
162.49.84.219
162.49.84.229
162.49.84.242
162.49.84.244
162.49.84.246
162.49.84.248
162.49.84.25
162.49.89.207
172.23.168.100
192.168.38.102
192.168.38.106
192.168.38.108
192.168.38.112
192.168.38.114
192.168.38.116
192.168.38.118
192.168.38.12
192.168.38.120
192.168.38.122
192.168.38.126
192.168.38.129
192.168.38.133
192.168.38.15
192.168.38.163
192.168.38.165
192.168.38.167
192.168.38.174
192.168.38.18
192.168.38.201
192.168.38.203
192.168.38.235
192.168.38.24
192.168.38.27
192.168.38.29
192.168.38.31
192.168.38.31
192.168.38.33
192.168.38.36
192.168.38.37
192.168.38.39
192.168.38.41
192.168.38.44
192.168.38.46
192.168.38.48
192.168.38.54
192.168.38.56
192.168.38.58
192.168.38.60
192.168.38.62
192.168.38.64
192.168.38.66
192.168.38.68
192.168.38.68
192.168.38.72
192.168.38.74
192.168.38.76
192.168.38.78
192.168.38.84
192.168.38.87
192.168.38.91
192.168.75.31
"@ -split [environment]::NewLine | ForEach-Object {
 
 try
 {
    
 

  [system.net.ipaddress]$IP = $_
 
  $iLO = Find-HPiLO $IP.IPAddressToString -Timeout 100
 
  $ILO | Export-Csv -Path "$env:HOMEDRIVE\Temp\iLO_info.csv" -Append -NoTypeInformation
 
 }
 catch
 {
   "Error was $_"
 }


}


