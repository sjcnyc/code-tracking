Function Get-PingsWithLog {
  [CmdletBinding()]
  Param (
    [int32]$Count = 0,
    [Parameter(ValueFromPipeline = $true)]
    [String[]]$Computer,
    [string]$LogPath = 'c:\temp\pinglog.csv'
  )

  $Ping = @()

  if (-not (Test-Path (Split-Path $LogPath) -PathType Container)) {
    New-Item (Split-Path $LogPath) -ItemType Directory | Out-Null
  }

  if (-not (Test-Path $LogPath)) {
    Add-Content -Value '"TimeStamp","Source","Destination","IPV4Address","Status","ResponseTime"' -Path $LogPath
  }

  #Log collection loop
  while ($Count -eq 0) {
    $Ping = Get-WmiObject Win32_PingStatus -Filter "Address = '$Computer'" |
      Select-Object @{Label = 'TimeStamp'; Expression = {Get-Date}}, `
    @{Label = 'Source'; Expression = { $_.__Server }}, `
    @{Label = 'Destination'; Expression = { $_.Address }}, `
      IPv4Address, `
    @{Label = 'Status'; Expression = { If ($_.StatusCode -ne 0) {'Failed'} Else {'Success'}}}, `
      ResponseTime

    $Result = $Ping | Select-Object TimeStamp, Source, Destination, IPv4Address, Status, ResponseTime | ConvertTo-Csv -NoTypeInformation
    $Result[1] | Add-Content -Path $LogPath
    Write-verbose ($Ping | Select-Object TimeStamp, Source, Destination, IPv4Address, Status, ResponseTime | Format-Table -AutoSize | Out-String)
    Start-Sleep -Seconds 1
  }
}

@"
APSYDVWJMP202
AR-0021CCC6F7B4
AR-002324769497
AR-002324769751
AR-507B9D97D80B
AR-6067203EFA5C
AR-60A44C63FC6E
AR-D8D3857C7BE9
ASSET1817
ATHGRCEUDSK322
ATSME028
atsme053
ATSME064
AU-00247E6AF912
AU-4C3488875456
AU-54EE7552A0DH
AU-5C514F3DBCED
AU-A44CC83FA880
BARLEN002
BOMSMEAPP02
BR-20040FFEB26C
BR-641C6788AD35
BR-641C6788AE0D
BR-641C6788AF49
BR-641C6788B015
BR-641C6788C581
BR-641C6788C616
BUDHUNEUDSK5407
BUEARGLADSK8100
CADF97M082
CALCNU425BRCX
CHW10M006
CL-C85B761F184A
CPHSMEBCKP0001
DED00199BDE02F
DEDA0D3C14FB8E9
DEL0C8BFD9E1AAB
DEL0C8BFDA23A32
DEL0C8BFDA23A46
DEL14ABC5AF7A67
DEL204153594EFF
DEL308D99BD4379
DEL34415DC30CAD
DEL3CA9F43EA5DC
DEL3CA9F44E7560
DEL801934215255
DEL80CE62A46E36
DEL80CE62A4AEA3
DELAC7BA15F5A9B
DELAC7BA19DBC0F
DELACE2D397A3DA
DELC4346B24F8B8
DELD0BF9C2249D7
DELD46D6D48BF39
DELE4A4719506A0
DELFCF8AE69E948
DELFCF8AE9DD8D9
DELFCF8AE9DE4F0
DELFCF8AE9E04D5
DELFCF8AE9F2D15
EULONVWJMP101
EULONVWJMP105
EULONVWOKT101
EUMUCPWAPP006
FRDS4EG1152
FRDS4EG1220
FRKUSANALPT4756
FRKUSANALPT8087
FRLPC0NMHM8
FRLPC0NMHPT
FRLPC0SZQWK
FRLPC0SZQWZ
FRLR9XCTK2
GBLUSANADSK3414
GBLUSANADSK5085
GBLUSANALPT1026
GBLUSANALPT118
GBLUSANALPT1430
GBLUSANALPT1465
GBLUSANALPT1911
GBLUSANALPT2638
GBLUSANALPT3059
GBLUSANALPT3151
GBLUSANALPT3479
GBLUSANALPT3601
GBLUSANALPT3681
GBLUSANALPT446
GBLUSANALPT539
GBLUSANALPT6354
GBLUSANALPT6779
GBLUSANALPT6968
GBLUSANALPT7316
GBLUSANALPT7388
GBLUSANALPT7513
GBLUSANALPT7777
GBLUSANALPT7904
GBLUSANALPT8100
GBLUSANALPT8522
GBLUSANALPT8744
GBLUSANALPT9164
GBLUSANALPT9355
GBLUSANALPT941
GBLUSANALPT9516
GBLUSANALPT9629
GBLUSANALPT9827
GBLUSANALPT9867
GBLUSANALPT9896
GBLUSANALPT9924
ID-507B9D215148
ID-DC4A3EE46DE2
ID-DC4A3EE8740A
INMUM017
INMUM021
INMUM039
INMUM046
INMUM061
INMUM107
INMUM140
JKTIDNAPDSK4566
JKTIDNAPLPT5350
JNBW10B-ADOLF
JNBW10B-JOHAN
JNBW10B-TANIA
JNBW10-JACQUIE
JNBW7B-HIROSHAN
JNBW7B-JADE
JNBW7B-LLEWELYN
JNBW7B-MARTIN
JNBW7B-NAOMI
JNBW7-NOMBULELO
JNBZAFEUDSK5336
JNBZAFEULPT840
JNBZAFEULPT8481
LONGBREULPT1805
LONGBREULPT3667
LONGBREULPT5015
LONGBREULPT6084
LONGBREULPT8307
MADCASVENT009
MADESPEULPT3111
MADESPEULPT498
madlen021
MADLEN025
MADLEN034
MADLEN084
MOWRUSEULPT1694
MOWRUSEULPT5562
MOWRUSEULPT7409
MUCDEUEULPT1168
MUCDEUEULPT2532
MUCDEUEULPT4264
MUCDEUEULPT448
MUCSMEOFS1001
MXCMEXLADSK6771
MXCMEXLALPT1426
MXCMEXLALPT4407
MXCMEXLALPT7852
MXCMEXLALPT8682
MXCMEXLALPT9851
MX-T440PC07G5VD
MX-T460PC0E7ZGE
MX-T470PF0X8BF7
MX-T470PF0YBYZU
MX-T470PF0YBZ0J
MX-T470PF0YC13A
MX-T470PF0YC5BV
MX-T470PF0YC5D5
MX-T470PF0YC9N7
MX-T470PF0YFGEA
MX-T470PF0YFGFA
MX-T470PF0YFT3R
MX-W10EDGARCI41
MX-W10EDROJO004
MX-W10ELARRED03
MX-W10ELBARR082
MX-W10ELEDUAR01
MX-W10ELFUENT02
MX-W10ELGIRON03
MX-W10ELJSANDIN
MX-W10ELMELG002
MX-W10ELPALAF01
MX-W10ELVENRIQU
MX-W10ELZENI002
MX-W7EDVIENA01
NO-HELENE14
NO-JK7SDFSDDSF
NZ-847BEB4BC1E2
OSLNOREULPT6721
PEKCHNAPDSK159
PEKCHNAPDSK5301
PL-74E6E24F5519
PL-9840BB325604
PL-BCAEC55AC135
PL-F8CAB85BD681
PL-F8CABB5BDGDC
RIOBRALALPT9670
RIOSBMEWFP004
SBMERU0127
SBMERU0130
SBMERU0165
SBMERU0169
SE-DELL7250-02
SELKORAPDSK7181
SELKORAPDSK9335
SEW2326YZ1
SEWB90XVZ1
SEWFINANCE1
SME-UK1230
SME-UK1544
SME-UK1700
SME-UK1719
SME-UK1757
SME-UK1762
SME-UK1763
SME-UK1766
SME-UK1771
SME-UK1779
SME-UK1788
SME-UK1790
SME-UK1805
SME-UK1810
SME-UK1831
SME-UK1850
SME-UK1871
SME-UK1906
SME-UK1994
SME-UK1998
SME-UK2000
SME-UK2093
SME-UK2107
SME-UK2136
SME-UK2191
SME-UK2198
SME-UK2252
STGCHLLALPT78
STOSWEEULPT1889
STOSWEEULPT1908
STOSWEEULPT8916
SYDAUSAPLPT1076
SYDAUSAPLPT3006
TMAHKGAPLPT1798
TMAHKGAPLPT1864
TNELSEN-LT
TORCANNADSK3279
TORCANNADSK414
TOR-INTERN-32
TOR-MAGOSTI-04
TPETWNAPDSK9098
TPETWNAPLPT1241
TPETWNAPLPT1742
TW-18A905EE50CD
TW-NB0040
TW-NB0085
TW-PC0321
TW-PC0449
ULL507B9D24E3B0
ULL507B9D24E657
ULL507B9D2CA9C2
ULL507B9D2CAAA3
ULL507B9D2CAC33
ULL507B9D48A8D0
ULL507B9D4B7E18
ULL507B9D5E76CF
ULL507B9D5E76D4
ULL507B9D5E76EC
ULL507B9D5E76F9
ULL507B9D5E76FB
ULL507B9D5E76FF
ULL507B9D5E770C
ULL507B9D5E7714
ULL507B9D5E7789
ULL507B9D5E7792
ULL507B9D5E77AC
ULL507B9D5E77AD
ULL507B9D5E77B1
ULL507B9D5E7823
ULL507B9D5E7827
ULL507B9D5E78A5
ULL507B9D5E78DA
ULL507B9D5E78DF
ULL507B9D5E78F7
ULL507B9D5E7934
ULL507B9D5E798F
ULL507B9D5E7A5A
ULL507B9D5E7A68
ULL507B9D5E7AC1
ULL507B9D5E7ACF
ULL507B9D5E7B06
ULL507B9D5E7B20
ULL507B9D5E7B3B
ULL507B9D5E7B4D
ULL507B9D5E7B6B
ULL507B9D5E7BB2
ULL507B9D5E7BF6
ULL507B9D5E7C02
ULL507B9D5E7CCA
ULL507B9D5E7D31
ULL507B9D5E7D43
ULL507B9D5E7D54
ULL507B9D5E7D56
ULL507B9D5E7D7A
ULL507B9D5E7DCA
ULL507B9D5E7DD9
ULL507B9D5E7E02
ULL507B9D5E7E04
ULL507B9D5E7E07
ULL507B9D5E7F07
ULL507B9D5E7F2D
ULL507B9D5E7F8D
ULL507B9D5E7F8F
ULL507B9D5E7F94
ULL507B9D5E7FA0
ULL507B9D5E7FA3
ULL507B9D5E7FB2
ULL507B9D5E7FB4
ULL507B9D5E8037
ULL507B9D5E803C
ULL507B9D5E8044
ULL507B9DBB87E8
ULL54EE757BE86C
ULL54EE757BE877
ULL68F728AC2AA2
ULLC85B7636E554
usculvwinf402
usculvwjmp524
usculvwprt402
USCULVWWEB209
USD3417EBB3567D
USD3417EBB71BA1
USD3417EBD30649
USD484D7EB059FE
USD64006A6BCB25
USD90B11C668FE7
USD90B11C865FA1
USDB8CA3A82D5BF
USDB8CA3A8D2AF2
USDD4BED9A74DF3
USDF8B156C69547
USDF8B156C6A91A
USL28D244B1A959
USL28D244DD9B63
USL507B9D24E529
USL507B9D2CA902
USL507B9D2CAB43
USL507B9D2CAEFF
USL507B9D2CAFE3
USL507B9D44E2A6
USL507B9D48A86C
USL507B9D48AA85
USL507B9D48AE29
USL507B9D48AE2A
USL507B9D48AF12
USL507B9D4B7E16
USL507B9D4B7F7A
USL507B9D4B7F8F
USL507B9D4B7F99
USL507B9D4B8125
USL507B9D4B8134
USL507B9D4B87AD
USL507B9D4B8DE0
USL507B9D4B93DD
USL507B9D5E76D9
USL507B9D5E7794
USL507B9D5E7830
USL507B9D5E7858
USL507B9D5E7859
USL507B9D5E790F
USL507B9D5E7A20
USL507B9D5E7C5A
USL507B9D5E7DDA
USL507B9D5E7DE5
USL507B9D5E7E7A
USL507B9D5E7F04
USL507B9D5E7F05
USL507B9D5E7F70
USL507B9D5E7F8C
USL507B9D5E8029
USL507B9D5E8039
USL507B9D74A15E
USL507B9DAA32C6
USL507B9DAA35C9
USL507B9DBB8589
USL507B9DBB85A1
USL507B9DBB87AD
USL507B9DD58C63
USL507B9DDAF7C9
USL507B9DE0E5BB
USL54E1AD552736
USL54E1AD58BFD2
USL54E1AD5C8EBD
USL54E1AD68DA1F
USL54E1ADA5D7DM
USL54E1ADD68B37
USL54E1ADFD2938
USL54EE751DC5D2
USL54EE75258E52
USL54EE757712C8
USL68F7280DF69A
USL68F728640F11
USL68F72865C88A
USL68F7286F06D0
USL8C1645069BED
USL8C16451879EA
USL8C1645187A36
USL8C1645187A6B
USL8C1645187B04
USL8C1645187B06
USL8C1645187B12
USL8C1645187B18
USL8C1645187B4D
USL8C1645187B8C
USL8C16455098E9
USLC85B761C31FB
USLC85B7628C170
USLC85B76C91599
USLC85B76C915F3
USLC85B76D60914
USLC85B76D610AF
USLC85B76DD58F9
USLC85B76E5204F
USLE86A643AC554
usnycvwokt304
usnycvwprt305
usnycvwrdb400
usnycvwrsh403
usnycvwrsh409
usnycvwrsh502
usnycvwrsh505
usnycvwrsh508
ussmevwapp327
ussmevwapp328
ussmevwapp330
UVM001C4220DE72
W10DBOGKARE009
W10DBOGMEND077
W10DBOGROCHA01
W10DCCSGUEV002
w10djktdani063
w10djkthusn002
w10djktkomal01a
W10DPEKCHUN017
W10DPEKLEI0001
W10DSELNAMY002
W10DSELPARK048A
W10DSHADAI06
W10LBOGCALD003
W10LBOGCAST177
W10LBOGKVAR07
W10LBOGOSPIN01
W10LBOGSANT111
W10LHKGME001
W10LHKGT410
W10LMILMONTA01
W10LMILRONCH02
W10LPEKTRAVEL03
W10LSELKIM32
W10LSJOES01
W10MADHP002
W7ATHIST003
W7BOGPRUEBA
W7DHKGCHAU07
W7DHKGHON01S
W7DJKTKHAI001
W7DJKTRAMA001
W7DKULMULTI001A
W7DPERKARE008
w7lbogkare009
W7LMANER01
W7LMILBIGL002
W7LMILIBAT01
W7LMILPATAR01
W7LMILPICCA01
wbxl2052
WBXL2054
ZRHCHEEULPT3905
"@ -split [Environment]::NewLine | ForEach-Object {

    Get-PingsWithLog -Computer $_ -Count 2
}